library(readxl)
library(zoo)
library(dplyr)
library(ggplot2)
library(magrittr)
set_who_name <- function(str){
  str <- gsub("_", " ", str)
  str <- ifelse(str == "Republic of Korea", "South Korea", str)
  #str <- ifelse(str == "Korea, Rep.", "South Korea", str)
  str <- gsub("Darussalam", "", str)
  #str <- ifelse(grepl("United Kingdom", str, ignore.case = TRUE), "UK", str)
  str <- ifelse(grepl("United States of America", str, ignore.case = TRUE), "United States", str)
  str <- ifelse(grepl("bosnia", str, ignore.case = TRUE), "Bosnia and Herzegovina", str)
  str <- ifelse(grepl("moldova", str, ignore.case = TRUE), "Moldova", str)
  str <- ifelse(grepl("iran", str, ignore.case = TRUE), "Iran", str)
  str <- ifelse(grepl("Palestin", str, ignore.case = TRUE), "West Bank and Gaza", str)
  str <- ifelse(grepl("viet", str, ignore.case = TRUE), "Vietnam", str)
  str <- ifelse(grepl("cze", str, ignore.case = TRUE), "Czech Republic", str)
  str <- gsub("\\s*\\([^\\)]+\\)","", str)
  str <- gsub("n Federation", "", str)
  str <- 
    gsub("(?<!^)\\b(?:the|an?|[io]n|at|with(?:out)?|from|for|and|but|n?or|yet|[st]o|around|by|after|along|from|of)\\b(*SKIP)(*FAIL)|\\b(\\pL)", "\\U\\1", str, perl=T)
  str <- ifelse(grepl("Côte d'Ivoire", str, ignore.case = TRUE), "Cote d'Ivoire", str)
  str <- ifelse(grepl("Tanzania", str, ignore.case = TRUE), "Tanzania", str)
  str <- ifelse(grepl("Cura", str, ignore.case = TRUE), "Curacao", str)
  str <- ifelse(grepl("Saint Barthélemy", str, ignore.case = TRUE), "Saint Barthelemy", str)
  str <- ifelse(grepl("Timor", str, ignore.case = TRUE), "Timor-Leste", str)
  str <- ifelse(grepl("Kosovo", str, ignore.case = TRUE), "Kosovo", str)
  str <- ifelse(grepl("Syria", str, ignore.case = TRUE), "Syria", str)
  str <- ifelse(grepl("Cape Verde", str, ignore.case = TRUE), "Cabo Verde", str)
  str <- ifelse(grepl("lao", str, ignore.case = TRUE), "Laos", str)
  str <- ifelse(grepl("Bissau", str, ignore.case = TRUE), "Guinea-Bissau", str)
  str <- ifelse(str == "El", "El Salvador", str)
  #str <- ifelse(str == "Korea South", "South Korea", str)
  #str <- ifelse(str == "US", "United States", str)
  str <- ifelse(str == "Burma", "Myanmar", str)
  str <- ifelse(grepl("Bonaire", str, ignore.case = TRUE), "Bonaire, Sint Eustatius and Saba", str)
  str <- ifelse(grepl("Príncipe", str, ignore.case = TRUE), "Sao Tome and Principe", str)
  str <- ifelse(grepl("Egypt", str, ignore.case = TRUE), "Egypt", str)
  str <- ifelse(grepl("Venezuela", str, ignore.case = TRUE), "Venezuela", str)
  str <- ifelse(grepl("Bahamas", str, ignore.case = TRUE), "Bahamas", str)
  str <- ifelse(grepl("Gambia", str, ignore.case = TRUE), "Gambia", str)
  #Slovak 
  str <- ifelse(grepl("^Kyrgyz", str, ignore.case = TRUE), "Kyrgyzstan", str)
  str <- ifelse(grepl("^Slovak", str, ignore.case = TRUE), "Slovakia", str)
  str <- ifelse(grepl("Kitts And Nevis", str, ignore.case = TRUE), "Saint Kitts and Nevis", str)
  str <- gsub(" And ", " and ", str, fixed = TRUE)
  str <- str %>% trimws()
  str <- gsub("††", "", str)
  str <- ifelse(str == "Congo", "Congo (Brazzaville)", str)
  str <- ifelse(str == "Democratic Republic of the Congo", "Congo (Kinshasa)", str)
  
  return(str)
}
